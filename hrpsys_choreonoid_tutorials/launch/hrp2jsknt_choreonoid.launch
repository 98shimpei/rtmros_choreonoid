<launch>
  <arg name="ENVIRONMENT_YAML" default="$(find hrpsys_choreonoid_tutorials)/config/flat.yaml" />

  <include file="$(find hrpsys_choreonoid_tutorials)/launch/robot_choreonoid.launch" >
    <!-- <arg name="USE_VISION" value="true" /> -->
    <arg name="USE_VISION"           value="false" />
    <!-- <arg name="LAUNCH_FOOTCOORDS" default="true" /> -->
    <arg name="LAUNCH_FOOTCOORDS"    value="false" />
    <arg name="ENVIRONMENT_YAML"     value="$(arg ENVIRONMENT_YAML)" />
    <arg name="CHOREONOID_ROBOT"     value="HRP2JSKNT"/>
    <arg name="MODEL_FILE"           value="$(find hrp2_models)/HRP2JSKNT_for_OpenHRP3/HRP2JSKNTmain.wrl"/>
    <arg name="COLLADA_FILE"         value="$(find hrpsys_ros_bridge_tutorials)/models/HRP2JSKNT_WH_SENSORS.urdf"/>
    <arg name="CONF_FILE"            value="$(find hrpsys_ros_bridge_tutorials)/models/HRP2JSKNT.conf"/>
    <arg name="HRPSYS_PY_PKG"        value="hrpsys_choreonoid_tutorials"/>
    <arg name="HRPSYS_PY_NAME"       value="hrp2_rh_setup.py" />
    <arg name="CONTROLLER_CONFIG"    value="$(find hrpsys_ros_bridge_tutorials)/models/HRP2JSKNT_controller_config.yaml" />
    <arg name="CUSTOMIZER_CONF_FILE" value="$(find hrpsys_choreonoid_tutorials)/config/HRP2JSKNTCustomizer.yaml" />
    <arg name="hrpsys_opt_rtc_config_args" value='-o "example.HRP3HandController_choreonoid.config_file:$(find hrpsys_ros_bridge_tutorials)/models/HRP2JSKNT.conf" -o "example.HRP3HandController_choreonoid.pdgains_sim_file_name:$(find jsk_hrp2_ros_bridge)/rtc/HRP3HandController/HRP3HAND.PDgains.dat"'/>
    <arg name="USE_REFERENCEFORCEUPDATER" value="false" />
    <arg name="USE_OBJECTCONTACTTURNAROUNDDETECTOR" value="false" />
  </include>

  <!-- HRP3HANDControllerServiceROSBridge -->
  <env name="LANG" value="C" />
  <env name="ORBgiopMaxMsgSize" value="2147483648" />
  <arg name="nameserver" default="localhost" />
  <arg name="corbaport" default="15005" />
  <arg name="managerport" default="2810" />
  <env name="RTCTREE_NAMESERVERS" value="$(arg nameserver):$(arg corbaport)" />
  <env name="RTC_CONNECTION_CHECK_ONCE" value="true" />

  <node pkg="jsk_hrp2_ros_bridge" name="HRP3HandControllerServiceROSBridge" type="HRP3HandControllerServiceROSBridgeComp"
        output="screen" args='-o "corba.master_manager:$(arg nameserver):$(arg managerport)" -o "corba.nameservers:$(arg nameserver):$(arg corbaport)" -o "naming.formats:%n.rtc" -o "exec_cxt.periodic.type:PeriodicExecutionContext" -o "exec_cxt.periodic.rate:2000" -o "logger.file_name:/tmp/rtc%p.log"' />
  <rtconnect from="HRP3HandControllerServiceROSBridge.rtc:HRP3HandControllerService" to="HRP3HandController_choreonoid0.rtc:HRP3HandControllerService" subscription_type="new"/>
  <rtactivate component="HRP3HandControllerServiceROSBridge.rtc" />
  <node name="rtmlaunch_hrp2jsknt_choreonoid" pkg="openrtm_tools" type="rtmlaunch.py" args="$(find hrpsys_choreonoid_tutorials)/launch/hrp2jsknt_choreonoid.launch" output="screen"/>

</launch>
